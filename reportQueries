sales_by|select p.product_id, p.product_name, p.product_type, s.total_quantity from product p left join  sales s on (p.product_id = s.product_id)
total_amount|select sum (allAmnt) from (select transaction_id,cast(substring(total_amount, 2, length(total_amount)) as float) allAmnt  from sale where year(TO_DATE(CAST(UNIX_TIMESTAMP(timestamp, 'MM/dd/yyyy') AS TIMESTAMP)))=2013 and transaction_id not in (select original_transaction_id from refund))a
customer_name|select customer_first_name,customer_last_type from customer where customer_id in (select customer_id from  (select customer_id, rank() over (order by sum desc) rk from (select customer_id,sum(cast(substring(total_amount, 2, length(total_amount)) as float)) sum from sale where month(TO_DATE(CAST(UNIX_TIMESTAMP(timestamp, 'MM/dd/yyyy') AS TIMESTAMP)))=3 and year(TO_DATE(CAST(UNIX_TIMESTAMP(timestamp, 'MM/dd/yyyy') AS TIMESTAMP)))=2013  group by customer_id)a)b where rk=2)
findProduct|select product.product_id, product.product_name from product where product.product_id not in (select distinct product_id from sales)
total_user_count|select count(*) from (select count(*),customer_id,product_id,TO_DATE(CAST(UNIX_TIMESTAMP(timestamp, 'MM/dd/yyyy') AS TIMESTAMP)) from sales group by customer_id,product_id,TO_DATE(CAST(UNIX_TIMESTAMP(timestamp, 'MM/dd/yyyy') AS TIMESTAMP)) having count(*)>=2)a
